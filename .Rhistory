data(mtcars)
head(mtcars)
x = cbind(1, mtcars$wt, mtcars$hp)
y = mtcars$mpg
head(x)
solve(t(x) %*% x) %*% t(x) %*% y
beta = solve(t(x) %*% x) %*% t(x) %*% y
coef(lm(mpg ~ wt + hp, data + mtcars))
coef(lm(mpg ~ wt + hp, data = mtcars))
head(mtcars)
data(mtcars)
head(mtcars)
data("swiss")
head(swiss)
x = cbind(1,swiss[,-1])
y = swiss$Fertility
beta=solve(t(x)%*%x) %*% t(x) %*% y
x = matrix(cbind(1,swiss[,-1]))
y = swiss$Fertility
beta=solve(t(x)%*%x) %*% t(x) %*% y
x = as.matrix(cbind(1,swiss[,-1]))
y = swiss$Fertility
beta=solve(t(x)%*%x) %*% t(x) %*% y
x = as.matrix(cbind(1,swiss[,-1]))
y = swiss$Fertility
beta=solve(t(x)%*%x) %*% t(x) %*% y
beta
lm(y~x)
predict.lm(lm(y~x),newData = data.frame(
Agriculture = 27.7,
Examination = 22,
Education = 29,
Catholic = 58.33,
Infant.Mortality = 19.3))
predict.lm(lm(y~swiss[,-1]),newData = data.frame(
Agriculture = 27.7,
Examination = 22,
Education = 29,
Catholic = 58.33,
Infant.Mortality = 19.3))
predict.lm(lm(y~as.matrix(swiss[,-1])),newData = data.frame(
Agriculture = 27.7,
Examination = 22,
Education = 29,
Catholic = 58.33,
Infant.Mortality = 19.3))
predict.lm(lm(y~as.matrix(swiss[,-1])),newData = data.frame(
xAgriculture = 27.7,
xExamination = 22,
xEducation = 29,
xCatholic = 58.33,
xInfant.Mortality = 19.3))
newData = data.frame(
+     xAgriculture = 27.7,
newData = data.frame(
Agriculture = 27.7,
Examination = 22,
Education = 29,
Catholic = 58.33,
Infant.Mortality = 19.3)
predict.lm(lm(y~as.matrix(swiss[,-1])),newdata = data.frame(c(27.7,22,29,58.33,19.3)))
predict.lm(lm(y~as.matrix(swiss[,-1])),newdata = data.frame(c(27.7,22,29,58.33,19.3)))
as.matrix(swiss[,-1])
View(x)
x = swiss[,-1]
x = as.matrix(swiss[,-1])
fit = lm(y~x)
prdict(fit)
predict(fit)
predict(fit,newdata = newData)
View(x)
fit = lm(y~t(x))
fit = lm(t(y)y~t(x))
fit = lm(t(y)~t(x))
fit = lm(y~x)
predict(fit,newdata = newData)
newData = data.frame(
Agriculture = c(27.7),
Examination = c(22),
Education = c(29),
Catholic = c(58.33),
Infant.Mortality = c(19.3))
predict(fit,newdata = newData)
newData
fit = lm(Fertility ~ *, data = swiss)
fit = lm(Fertility ~ ., data = swiss)
predict(fit,newdata = newData)
t(x)%*%beta
t(c(1,27.7,22,29,58.33,19.3))%*%beta
data(mtcars)
x1 = mtcars$wt[mtcars$vs=1]
data(mtcars)
x1 = mtcars$wt[mtcars$vs==1]
x2 = mtcars$wt[mtcars$vs==0]
data(mtcars)
x1 = mtcars$wt[mtcars$vs==1]
x2 = mtcars$wt[mtcars$vs==0]
y1 = mtcars$mpg[mtcars$vs==1]
y2 = mtcars$mpg[mtcars$vs==0]
data(mtcars)
x1 = mtcars$wt[mtcars$vs==1]
x1c = x1 - mean(x1)
x2 = mtcars$wt[mtcars$vs==0]
x2c = x2 - mean(x2)
y1 = mtcars$mpg[mtcars$vs==1]
y1c = y1 - mean(y1)
y2 = mtcars$mpg[mtcars$vs==0]
y2c = y2 - mean(y2)
beta1 = (y1c %*% x1c)/(x1c %*% x1c)
beta2 = (y2c %*% x2c)/(x2c %*% x2c)
data(mtcars)
x1 = mtcars$wt[mtcars$vs==1]
x1c = x1 - mean(x1)
x2 = mtcars$wt[mtcars$vs==0]
x2c = x2 - mean(x2)
y1 = mtcars$mpg[mtcars$vs==1]
y1c = y1 - mean(y1)
y2 = mtcars$mpg[mtcars$vs==0]
y2c = y2 - mean(y2)
beta1 = (y1c %*% x1c)/(x1c %*% x1c)
beta2 = (y2c %*% x2c)/(x2c %*% x2c)
mean(y1) - mean(y2) - (mean(x1)*beta1 + mean(x2)*beta2)
data(mtcars)
x1 = mtcars$wt[mtcars$vs==1]
x1c = x1 - mean(x1)
x2 = mtcars$wt[mtcars$vs==0]
x2c = x2 - mean(x2)
y1 = mtcars$mpg[mtcars$vs==1]
y1c = y1 - mean(y1)
y2 = mtcars$mpg[mtcars$vs==0]
y2c = y2 - mean(y2)
beta1 = (y1 %*% x1)/(x1 %*% x1)
beta2 = (y2 %*% x2)/(x2 %*% x2)
mean(y1) - mean(y2) - (mean(x1)*beta1 + mean(x2)*beta2)
data(mtcars)
x1 = mtcars$wt[mtcars$vs==1]
x1c = x1 - mean(x1)
x2 = mtcars$wt[mtcars$vs==0]
x2c = x2 - mean(x2)
y1 = mtcars$mpg[mtcars$vs==1]
y1c = y1 - mean(y1)
y2 = mtcars$mpg[mtcars$vs==0]
y2c = y2 - mean(y2)
beta1 = (y1c %*% x1c)/(x1c %*% x1c)
beta2 = (y2c %*% x2c)/(x2c %*% x2c)
mean(y1) - mean(y2) - (mean(x1)*beta1 + mean(x2)*beta2)
y1c %*% x1c
y1c * x1c
data(mtcars)
x1 = mtcars$wt[mtcars$vs==1]
x1c = x1 - mean(x1)
x2 = mtcars$wt[mtcars$vs==0]
x2c = x2 - mean(x2)
y1 = mtcars$mpg[mtcars$vs==1]
y1c = y1 - mean(y1)
y2 = mtcars$mpg[mtcars$vs==0]
y2c = y2 - mean(y2)
beta1 = (y1c %*% x1c)/(x1c %*% x1c)
beta2 = (y2c %*% x2c)/(x2c %*% x2c)
p = sum(x1c**2)/(sum(x1c**2)+sum(x2c**2))
mean(y1) - mean(y2) - (mean(x1)*beta1 + mean(x2)*beta2)
data(mtcars)
x1 = mtcars$wt[mtcars$vs==1]
x1c = x1 - mean(x1)
x2 = mtcars$wt[mtcars$vs==0]
x2c = x2 - mean(x2)
y1 = mtcars$mpg[mtcars$vs==1]
y1c = y1 - mean(y1)
y2 = mtcars$mpg[mtcars$vs==0]
y2c = y2 - mean(y2)
beta1 = (y1c %*% x1c)/(x1c %*% x1c)
beta2 = (y2c %*% x2c)/(x2c %*% x2c)
p = sum(x1c**2)/(sum(x1c**2)+sum(x2c**2))
beta = p*beta1 + (1-p)*beta2
mean(y1) - mean(y2) - (mean(x1)*beta - mean(x2)*beta)
data(mtcars)
x1 = mtcars$wt[mtcars$vs==1]
x1c = x1 - mean(x1)
x2 = mtcars$wt[mtcars$vs==0]
x2c = x2 - mean(x2)
y1 = mtcars$mpg[mtcars$vs==1]
y1c = y1 - mean(y1)
y2 = mtcars$mpg[mtcars$vs==0]
y2c = y2 - mean(y2)
beta1 = (y1c %*% x1c)/(x1c %*% x1c)
beta2 = (y2c %*% x2c)/(x2c %*% x2c)
p = sum(x1c**2)/(sum(x1c**2)+sum(x2c**2))
beta = p*beta1 + (1-p)*beta2
mean(y1) - mean(y2) - (mean(x1)*beta1 - mean(x2)*beta2)
data(mtcars)
x1 = mtcars$wt[mtcars$vs==1]
x1c = x1 - mean(x1)
x2 = mtcars$wt[mtcars$vs==0]
x2c = x2 - mean(x2)
y1 = mtcars$mpg[mtcars$vs==1]
y1c = y1 - mean(y1)
y2 = mtcars$mpg[mtcars$vs==0]
y2c = y2 - mean(y2)
beta1 = (y1c %*% x1c)/(x1c %*% x1c)
beta2 = (y2c %*% x2c)/(x2c %*% x2c)
p = sum(x1c**2)/(sum(x1c**2)+sum(x2c**2))
beta = p*beta1 + (1-p)*beta2
mean(y1) - mean(y2) - (mean(x1)*beta - mean(x2)*beta)
beta
